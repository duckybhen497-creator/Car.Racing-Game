<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Car Racing Game App</title>
  <style>
    body { margin:0; background:#101317; display:flex; justify-content:center; align-items:center; height:100vh; }
    canvas { background:#2b2b2b; border-radius:12px; }
  </style>
</head>
<body>
<canvas id="gameCanvas" width="600" height="900"></canvas>
<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
const W = canvas.width, H = canvas.height;
let score = 0;
let level = 1;
let running = true;

// Car object
const car = { x: W/2 - 25, y: H - 140, w: 50, h: 100, speed: 6 };
let obstacles = [];
let keys = {};

// Event listeners
window.addEventListener('keydown', e => keys[e.key.toLowerCase()] = true);
window.addEventListener('keyup', e => keys[e.key.toLowerCase()] = false);

// Spawn obstacles
function spawnObstacle() {
  const laneWidth = W / 3;
  const lane = Math.floor(Math.random() * 3);
  const w = laneWidth * 0.7;
  const h = 40 + Math.random() * 50;
  const x = lane * laneWidth + (laneWidth - w)/2;
  obstacles.push({ x, y: -h, w, h, speed: 3 + Math.random()*2 });
}

// Collision detection
function rectIntersect(a,b){
  return !(a.x + a.w < b.x || a.x > b.x + b.w || a.y + a.h < b.y || a.y > b.y + b.h);
}

// Game loop
function update(){
  if(!running) return;

  // Move car
  if(keys['arrowleft'] || keys['a']) car.x -= car.speed;
  if(keys['arrowright'] || keys['d']) car.x += car.speed;
  // Keep car inside canvas
  if(car.x < 0) car.x = 0;
  if(car.x > W - car.w) car.x = W - car.w;

  // Spawn obstacles
  if(Math.random() < 0.02) spawnObstacle();

  // Move obstacles & check collision
  for(let i=obstacles.length-1; i>=0; i--){
    const o = obstacles[i];
    o.y += o.speed;
    if(rectIntersect(o, car)) running = false;
    if(o.y > H) { obstacles.splice(i,1); score += 10; }
  }

  level = Math.floor(score/100) + 1;
}

function draw(){
  ctx.clearRect(0,0,W,H);
  // Road
  ctx.fillStyle = '#303030';
  ctx.fillRect(0,0,W,H);
  // Car
  ctx.fillStyle = '#1f8cf7';
  ctx.fillRect(car.x, car.y, car.w, car.h);
  // Obstacles
  ctx.fillStyle = '#b22222';
  obstacles.forEach(o => ctx.fillRect(o.x, o.y, o.w, o.h));
  // HUD
  ctx.fillStyle = '#fff';
  ctx.font = '20px Arial';
  ctx.fillText('Score: '+score, 10, 30);
  ctx.fillText('Level: '+level, 10, 60);
  if(!running){
    ctx.fillStyle = 'rgba(0,0,0,0.6)';
    ctx.fillRect(W/2-150,H/2-70,300,140);
    ctx.fillStyle = '#fff';
    ctx.textAlign = 'center';
    ctx.font = '28px Arial';
    ctx.fillText('Game Over', W/2,H/2-10);
    ctx.font = '16px Arial';
    ctx.fillText('Refresh page to restart', W/2,H/2+30);
  }
}

function gameLoop(){
  update();
  draw();
  requestAnimationFrame(gameLoop);
}

gameLoop();
</script>
</body>
</html>
